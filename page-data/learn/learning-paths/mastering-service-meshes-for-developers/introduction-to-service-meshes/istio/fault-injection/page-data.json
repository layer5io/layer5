{"componentChunkName":"component---src-templates-learn-chapter-js","path":"/learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/fault-injection/","result":{"data":{"chapter":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"docType\": \"Chapter\",\n  \"chapterTitle\": \"Fault Injection\",\n  \"description\": \"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads.\",\n  \"videos\": 4,\n  \"lectures\": 12,\n  \"order\": 6\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(ChapterStyle, {\n    mdxType: \"ChapterStyle\"\n  }, mdx(\"p\", null, \"In this chapter we will learn how to test the resiliency of an application by injecting systematic faults.\\nBefore we start, we will need to reset the virtual services.\"), mdx(\"p\", null, \"Using Meshery, navigate to the Istio management page:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Enter \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Namespace\"), \" field.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click the (+) icon on the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Apply Custom Configuration\"), \" card and paste the configuration below.\")), mdx(\"p\", null, \"Config:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"apiVersion: networking.istio.io/v1alpha3\\nkind: VirtualService\\nmetadata:\\n  name: reviews\\nspec:\\n  hosts:\\n    - reviews\\n  http:\\n    - route:\\n        - destination:\\n            host: reviews\\n            subset: v2\\n\")), mdx(\"h2\", {\n    className: \"chapter-sub-heading\"\n  }, \"Inject a route rule to create a fault using HTTP delay\"), mdx(\"p\", null, \"To start, we will inject a 7s delay for accessing the ratings service for a user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \". reviews v2 service has a 10s hard-coded connection timeout for its calls to the ratings service configured globally.\"), mdx(\"p\", null, \"Using Meshery, navigate to the Istio management page:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Enter \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Namespace\"), \" field.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click the (+) icon on the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Apply Custom Configuration\"), \" card and paste the configuration below.\")), mdx(\"p\", null, \"This will update the existing virtual service definition for ratings to inject a delay for user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \" to access the ratings V1.\"), mdx(\"p\", null, \"In a few, we should be able to verify the virtual service by using the command below:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl get virtualservice ratings -o yaml\\n\")), mdx(\"p\", null, \"Config:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"apiVersion: networking.istio.io/v1alpha3\\nkind: VirtualService\\nmetadata:\\n  name: ratings\\nspec:\\n  hosts:\\n    - ratings\\n  http:\\n    - fault:\\n        delay:\\n          fixedDelay: 7s\\n          percentage:\\n            value: 100\\n      match:\\n        - headers:\\n            end-user:\\n              exact: jason\\n      route:\\n        - destination:\\n            host: ratings\\n            subset: v1\\n    - route:\\n        - destination:\\n            host: ratings\\n            subset: v1\\n\")), mdx(\"p\", null, \"Now we login to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/productpage\"), \" as user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \" and observe that the page loads but because of the induced delay between services the reviews section will show :\"), mdx(\"b\", null, \"Error fetching product reviews!\"), \"Sorry, product reviews are currently unavailable for this book.\", mdx(\"p\", null, \"If you logout or login as a different user, the page should load normally without any errors.\"), mdx(\"h2\", {\n    className: \"chapter-sub-heading\"\n  }, \"Inject a route rule to create a fault using HTTP abort\"), mdx(\"p\", null, \"In this section, , we will introduce an HTTP abort to the ratings microservices for user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \".\"), mdx(\"p\", null, \"Using Meshery, navigate to the Istio management page:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Enter \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Namespace\"), \" field.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click the (+) icon on the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Apply Custom Configuration\"), \" card and paste the configuration below.\")), mdx(\"p\", null, \"This will update the existing virtual service definition for ratings to inject a HTTP abort for user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \" to access the ratings V1.\"), mdx(\"p\", null, \"In a few, we should be able to verify the virtual service by using the command below:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl get virtualservice ratings -o yaml\\n\")), mdx(\"p\", null, \"Config:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"apiVersion: networking.istio.io/v1alpha3\\nkind: VirtualService\\nmetadata:\\n  name: ratings\\nspec:\\n  hosts:\\n    - ratings\\n  http:\\n    - fault:\\n        abort:\\n          httpStatus: 500\\n          percentage:\\n            value: 100\\n      match:\\n        - headers:\\n            end-user:\\n              exact: jason\\n      route:\\n        - destination:\\n            host: ratings\\n            subset: v1\\n    - route:\\n        - destination:\\n            host: ratings\\n            subset: v1\\n\")), mdx(\"p\", null, \"Now we login to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/productpage\"), \" as user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jason\"), \" and observe that the page loads without any new delays but because of the induced fault between services the reviews section will show:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Ratings service is currently unavailable\"), \".\"), mdx(\"h3\", {\n    className: \"chapter-sub-heading\"\n  }, \" Verify fault injection\"), mdx(\"p\", null, \"Verify the fault injection by logging out (or logging in as a different user), the page should load normally without any errors.\"), mdx(\"br\", null), mdx(\"h3\", null, \"Alternative: Manual installation\"), \"Follow these steps if the above steps did not work\", mdx(\"br\", null), mdx(\"br\", null), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \"Route all traffic to version V1 of all services\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/networking/virtual-service-all-v1.yaml\\n\")), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \"Route all traffic to version V2 of reviews for user Jason\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/networking/virtual-service-reviews-test-v2.yaml\\n\")), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \" Inject 7s delay for ratings service\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/networking/virtual-service-ratings-test-delay.yaml\\n\")), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \" Inject HTTP abort for ratings service\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/networking/virtual-service-ratings-test-abort.yaml\\n\"))));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"chapterTitle":"Fault Injection","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads."},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/fault-injection/","course":"introduction-to-service-meshes","learnpath":"mastering-service-meshes-for-developers","chapter":"fault-injection"}},"course":{"nodes":[{"frontmatter":{"courseTitle":"Introduction to Service Meshes - Hands On","meshesYouLearn":[{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/731763d720780a49c2ffdfede8c28f4b/istio.svg"},"name":"Istio"},{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/b4f4020971de42f6fb2497075a67f325/linkerd.svg"},"name":"Linkerd"}]},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/"}}]},"TOC":{"nodes":[{"frontmatter":{"order":8,"chapterTitle":"Circuit Breaking"},"fields":{"section":"istio","chapter":"circuit-breaking"}},{"frontmatter":{"order":9,"chapterTitle":"Conclusion"},"fields":{"section":"istio","chapter":"conclusion"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"istio","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Istio Ingress Gateway"},"fields":{"section":"istio","chapter":"expose-services"}},{"frontmatter":{"order":6,"chapterTitle":"Fault Injection"},"fields":{"section":"istio","chapter":"fault-injection"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"istio","chapter":"getting-started"}},{"frontmatter":{"order":7,"chapterTitle":"Mutual TLS & Identity Verification"},"fields":{"section":"istio","chapter":"mutual-tls"}},{"frontmatter":{"order":4,"chapterTitle":"Observability"},"fields":{"section":"istio","chapter":"observability"}},{"frontmatter":{"order":5,"chapterTitle":"Request Routing and Canary Testing"},"fields":{"section":"istio","chapter":"routing-and-canary"}},{"frontmatter":{"order":9,"chapterTitle":"Conclusion"},"fields":{"section":"linkerd","chapter":"conclusion"}},{"frontmatter":{"order":4,"chapterTitle":"Linkerd Dashboard"},"fields":{"section":"linkerd","chapter":"dashboard"}},{"frontmatter":{"order":5,"chapterTitle":"Debugging (Optional)"},"fields":{"section":"linkerd","chapter":"debugging"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"linkerd","chapter":"deploy-an-application"}},{"frontmatter":{"order":8,"chapterTitle":"Fault Injection"},"fields":{"section":"linkerd","chapter":"fault-injection"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"linkerd","chapter":"getting-started"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Linkerd Ingress"},"fields":{"section":"linkerd","chapter":"expose-services"}},{"frontmatter":{"order":6,"chapterTitle":"Observability"},"fields":{"section":"linkerd","chapter":"observability"}},{"frontmatter":{"order":7,"chapterTitle":"Traffic Splitting using SMI and Linkerd"},"fields":{"section":"linkerd","chapter":"traffic-splitting"}}]},"serviceMeshesList":{"nodes":[{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}}]}},"pageContext":{"learnpath":"mastering-service-meshes-for-developers","slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/fault-injection/","course":"introduction-to-service-meshes","section":"istio","chapter":"fault-injection","pageType":"chapter"}},"staticQueryHashes":["2449327605","4047814605"]}