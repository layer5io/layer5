{"componentChunkName":"component---src-templates-learn-chapter-js","path":"/learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/deploy-an-application.html","result":{"data":{"chapter":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"docType\": \"Chapter\",\n  \"chapterTitle\": \"Deploy a sample application\",\n  \"description\": \"Meshery, collaborative Kubernetes manager\",\n  \"videos\": 4,\n  \"lectures\": 12,\n  \"order\": 2\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(ChapterStyle, {\n    mdxType: \"ChapterStyle\"\n  }, mdx(\"p\", null, \"To play with Istio and demonstrate some of it's capabilities, you will deploy the example BookInfo application, which is included the Istio package.\"), mdx(\"h2\", {\n    className: \"chapter-sub-heading\"\n  }, \"What is the Bookinfo Application \"), mdx(\"br\", null), \"This application is a polyglot composition of microservices are written in different languages and sample BookInfo application displays information about a book, similar to a single catalog entry of an online book store. Displayed on the page is a description of the book, book details (ISBN, number of pages, and so on), and a few book reviews.\", mdx(\"p\", null, \"The end-to-end architecture of the application is shown in the figure.\"), mdx(\"br\", null), mdx(\"a\", {\n    href: BookInfoOffMesh\n  }, mdx(\"img\", {\n    src: BookInfoOffMesh,\n    width: \"100%\",\n    align: \"center\"\n  })), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Figure: BookInfo deployed off the mesh\")), mdx(\"br\", null), \"It\\u2019s worth noting that these services have no dependencies on Istio, but make an interesting service mesh example, particularly because of the multitude of services, languages and versions for the reviews service.\", mdx(\"p\", null, \"As shown in the figure below, proxies are sidecarred to each of the application containers.\"), mdx(\"br\", null), mdx(\"a\", {\n    href: BookInfoOnMesh\n  }, mdx(\"img\", {\n    src: BookInfoOnMesh,\n    width: \"100%\",\n    align: \"center\"\n  })), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Figure: BookInfo deployed on the mesh\")), mdx(\"br\", null), \"Sidecars proxy can be either manually or automatically injected into the pods. Automatic sidecar injection requires that your Kubernetes api-server supports `admissionregistration.k8s.io/v1` or `admissionregistration.k8s.io/v1beta1` or `admissionregistration.k8s.io/v1beta2` APIs. Verify whether your Kubernetes deployment supports these APIs by executing:\", mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl api-versions | grep admissionregistration\\n\")), mdx(\"p\", null, \"If your environment \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"does NOT\"), \" supports either of these two APIs, then you may use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"#manual-sidecar-inj\"\n  }, \"manual sidecar injection\"), \" to deploy the sample app.\"), mdx(\"p\", null, \"As part of Istio deployment in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"./getting-started\"\n  }, \"Previous chapter\"), \", you have deployed the sidecar injector.\"), mdx(\"br\", null), mdx(\"h2\", {\n    className: \"chapter-sub-heading\"\n  }, mdx(\"a\", {\n    name: \"auto\"\n  }), \" Deploying Sample App with Automatic sidecar injection\"), mdx(\"br\", null), \"Istio, deployed as part of this workshop, will also deploy the sidecar injector. Let us now verify sidecar injector deployment.\", mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl -n istio-system get configmaps istio-sidecar-injector\\n\")), mdx(\"p\", null, \"Output:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"NAME                     DATA   AGE\\nistio-sidecar-injector   2      9h\\n\")), mdx(\"p\", null, \"NamespaceSelector decides whether to run the webhook on an object based on whether the namespace for that object matches the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors\"\n  }, \"selector\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl get namespace -L istio-injection\\n\")), mdx(\"p\", null, \"Output:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"NAME           STATUS    AGE       ISTIO-INJECTION\\ndefault        Active    1h        enabled\\nistio-system   Active    1h        disabled\\nkube-public    Active    1h\\nkube-system    Active    1h\\n\")), mdx(\"p\", null, \"Using Meshery, navigate to the Istio management page.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Enter \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Namespace\"), \" field.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click the (+) icon on the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Sample Application\"), \" card and select \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"BookInfo Application\"), \" from the list.\")), mdx(\"p\", null, \"This will do 3 things:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Label \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" namespace for sidecar injection.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Deploys all the BookInfo services in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" namespace.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Deploys the virtual service and gateway needed to expose the BookInfo's productpage application in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"default\"), \" namespace.\")), mdx(\"h3\", {\n    className: \"chapter-sub-heading\"\n  }, mdx(\"a\", {\n    name: \"verify\"\n  }), \" Verify Bookinfo deployment\", \" \"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Verify that the deployments are all in a state of AVAILABLE before continuing.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"watch kubectl get deployment\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose a service, for instance \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"productpage\"), \", and view it's container configuration:\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl get po\\n\\nkubectl describe pod productpage-v1-.....\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Examine details of the services:\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl describe svc productpage\\n\")), mdx(\"p\", null, \"Next, you will expose the BookInfo application to be accessed external from the cluster.\"), mdx(\"br\", null), mdx(\"h3\", null, \"Alternative: Manual installation \"), \"Follow this if the above steps did not work for you\", mdx(\"br\", null), mdx(\"br\", null), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \" Label namespace for injection\"), mdx(\"p\", null, \"Label the default namespace with istio-injection=enabled\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl label namespace default istio-injection=enabled\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl get namespace -L istio-injection\\n\")), mdx(\"p\", null, \"Output:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"NAME           STATUS    AGE       ISTIO-INJECTION\\ndefault        Active    1h        enabled\\nistio-system   Active    1h        disabled\\nkube-public    Active    1h\\nkube-system    Active    1h\\n\")), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \" Deploy BookInfo\"), mdx(\"br\", null), mdx(\"p\", null, \"Applying this yaml file included in the Istio package you collected in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"./getting-started\"\n  }, \"Getting Started\"), \" will deploy the BookInfo app in you cluster.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml\\n\")), mdx(\"h4\", {\n    className: \"chapter-alt-heading\"\n  }, \"Deploy Gateway and Virtual Service for BookInfo app\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml\\n\")), mdx(\"hr\", null), mdx(\"br\", null), mdx(\"h3\", null, mdx(\"a\", {\n    name: \"manual-sidecar-inj\"\n  }), \"Manual Sidecar Injection\"), mdx(\"p\", null, \"Use this only when Automatic Sidecar injection doesn't work\"), mdx(\"p\", null, \"To do a manual sidecar injection we will be using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"istioctl\"), \" command:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"curl https://raw.githubusercontent.com/istio/istio/master/samples/bookinfo/platform/kube/bookinfo.yaml | istioctl kube-inject -f - > newBookInfo.yaml\\n\")), mdx(\"p\", null, \"Observing the new yaml file reveals that additional container Istio Proxy has been added to the Pods with necessary configurations:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"        image: docker.io/istio/proxyv2:1.3.0\\n        imagePullPolicy: IfNotPresent\\n        name: istio-proxy\\n\")), mdx(\"p\", null, \"We need to now deploy the new yaml using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f newBookInfo.yaml\\n\")), mdx(\"p\", null, \"To do both in a single command:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"kubectl apply -f <(curl https://raw.githubusercontent.com/istio/istio/master/samples/bookinfo/platform/kube/bookinfo.yaml | istioctl kube-inject -f -)\\n\")), mdx(\"p\", null, \"Now continue to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"#verify\"\n  }, \"Verify Bookinfo deployment\"), \".\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"chapterTitle":"Deploy a sample application","description":"Meshery, collaborative Kubernetes manager"},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/deploy-an-application","course":"advance-concepts-of-service-mesh","learnpath":"mastering-service-meshes-for-developers","chapter":"deploy-an-application"}},"course":{"nodes":[{"frontmatter":{"courseTitle":"Advance Concepts of Service Meshes - Hands On","meshesYouLearn":[{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/731763d720780a49c2ffdfede8c28f4b/istio.svg"},"name":"Istio"},{"imagepath":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRl4CAABXRUJQVlA4WAoAAAAQAAAAEwAAEgAAQUxQSCsBAAABkK1t27FFd7Zt2y3WBti2bdvWmrHU0Q7YNbbtybZdz+D7/m2IiAkAY8hqnoBA3moIOFSBTPv19+/X7TJQYSm67VOG5X16pafcd1sEQNydhzdp5yCXnytw+exwJ4mXx118lV7aQLbj+psDROvOlwNsX9Iq9cze9CrB+iEN6EBvmG5ne4jeXf3aOcjm5wpePqsWhdOPq3dER/kC8h/oqx3E6s8X/bkE8g+J4mF+j0YfU7829EfonjniiWKw8dMFos/ptEoELj83EPPfbhq8Fi6ami4WvJC2y8EveqQFwyc//4timb27dlohXDz7XyRbsUTzxfwkyxOmB5owmiCmp9wiDLcnZcJoYRDhBlAfjdmmZzTnWTyL6Hqwz+7S1CTtzYJjz8eeXFyej72YAABWUDggDAEAANAGAJ0BKhQAEwA+0VykTqglIyIoCqkAGglsALsyhHtYgrcJsK8xLFfoAdLcXseXeC9VGgsgkUpjlH7xR/xXEADeLYf7CYczoIv9t/vBQKOfOllI+unz6A0lUpkyuYCaKrQ3V/cH/zwEMeMfwM3TEUaJUejIEnllgZV0KT+dRXgVwdljiM/5bOUho/K6UAbp3tBPzBB385WEFco7bcPG7AiNcgse0VFkQn/VypGu+AnTdSJIx1S2ryZdD/2XLOJ/2cfL0Hca9wb71w7I4H9Yu5BrsoDN2sW9vnwGPwP0y+vhwJpyyj8G2UOOH3E7diegyWWXc0Z6zTp5+P+Tfv1AmHIlVCYdE2okyAD9gAA="},"images":{"fallback":{"src":"/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp","srcSet":"/static/ca53815f6e4054379084f39f253f9a9d/02e18/linkerd.webp 13w,\n/static/ca53815f6e4054379084f39f253f9a9d/04db5/linkerd.webp 25w,\n/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp 50w,\n/static/ca53815f6e4054379084f39f253f9a9d/2d116/linkerd.webp 100w","sizes":"(min-width: 50px) 50px, 100vw"},"sources":[]},"width":50,"height":47}},"extension":"webp","publicURL":"/static/ca53815f6e4054379084f39f253f9a9d/linkerd.webp"},"name":"Linkerd"}]},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh"}}]},"TOC":{"nodes":[{"frontmatter":{"order":8,"chapterTitle":"Conclusion"},"fields":{"section":"istio","chapter":"conclusion"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"istio","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Istio Ingress Gateway"},"fields":{"section":"istio","chapter":"expose-services"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"istio","chapter":"getting-started"}},{"frontmatter":{"order":4,"chapterTitle":"Observability"},"fields":{"section":"istio","chapter":"observability"}},{"frontmatter":{"order":6,"chapterTitle":"Service security capabilities"},"fields":{"section":"istio","chapter":"service-security-capabilities"}},{"frontmatter":{"order":5,"chapterTitle":"Traffic management"},"fields":{"section":"istio","chapter":"traffic-management"}},{"frontmatter":{"order":7,"chapterTitle":"WebAssembly and intelligent data planes"},"fields":{"section":"istio","chapter":"webassembly-and-intelligent-data-planes"}}]},"serviceMeshesList":{"nodes":[{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}}]}},"pageContext":{"learnpath":"mastering-service-meshes-for-developers","slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/deploy-an-application","course":"advance-concepts-of-service-mesh","section":"istio","chapter":"deploy-an-application","pageType":"chapter"}},"staticQueryHashes":["3750885592","4047814605"],"slicesMap":{},"matchPath":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/deploy-an-application"}