name: Label Triggered Workflow

on:
  issues:
    types:
      - labeled

  pull_request_target:
    types:
      - labeled

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
        with:
          ref: master

      - name: Label Commenter
        uses: peaceiris/actions-label-commenter@v1

      - name: Verify Valid Issue
        if: contains(github.event.issue.labels.*.name, 'issue/valid')
        run: |
          echo "This issue has been verified as valid. Please take appropriate action in accordance with the description provided in the issue."
          # You can customize the comment message above as needed.

      - name: Help Wanted Issue
        if: contains(github.event.issue.labels.*.name, 'help wanted')
        run: |
          echo "This issue is marked as 'help wanted'. If you can help, please consider contributing to this issue."

      - name: View context attributes
        uses: actions/github-script@master
        id: set-url
        with:
          script: |
            const url = context.issue.url
            return url
          result-encoding: string

      - name: Get url
        run: |
          echo "URL=${{steps.set-url.outputs.result}}" >> $GITHUB_ENV
          echo "ISSUE=${{steps.set-url.outputs.url}}" >> $GITHUB_ENV

      - name: Notify slack
        if: contains(github.event.issue.labels.*.name, 'issue/valid')
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
        uses: pullreminders/slack-action@master
        with:
          args: '{\"channel\":\"CF9RK4H89\",\"text\":\"This issue has been verified as valid. Please take appropriate action in accordance with the description provided in the issue.\"}'

          # You can customize the Slack notification message above as needed.
