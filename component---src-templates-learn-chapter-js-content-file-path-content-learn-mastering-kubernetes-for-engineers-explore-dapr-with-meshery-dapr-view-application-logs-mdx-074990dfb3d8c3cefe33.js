"use strict";(self.webpackChunkLayer5=self.webpackChunkLayer5||[]).push([[91541],{39556:function(e,t,n){n.r(t),n.d(t,{Head:function(){return u},default:function(){return d}});n(20410);var a=n(28453),r=n(96540),o=n(94441),l=n.p+"static/stream-0147a3ab898c171b71eef36c3b780491.png";function s(e){const t=Object.assign({p:"p",a:"a",strong:"strong",pre:"pre",code:"code",ol:"ol",li:"li",em:"em"},(0,a.R)(),e.components);return r.createElement(o.x,null,r.createElement(t.p,null,"In this chapter, we will explore how Dapr utilizes its ",r.createElement(t.a,{href:"https://docs.dapr.io/concepts/building-blocks-concept/"},"API constructs")," to facilitate communication and manage the state of application data within this architecture by observing the container logs."),r.createElement("h3",{className:"chapter-sub-heading"},"Python Application Logs"),r.createElement(t.p,null,"The Python application code above generates messages that contain data with an ",r.createElement(t.strong,null,"orderId")," that increments once per second."),r.createElement(t.p,null,"Here's a snippet from the Python script in ",r.createElement(t.strong,null,"app.js"),":"),r.createElement(t.pre,null,r.createElement(t.code,{className:"language-python"},'dapr_port = os.getenv("DAPR_HTTP_PORT", 3500)\ndapr_url = "http://localhost:{}/neworder".format(dapr_port)\n\nn = 0\nwhile True:\n    n += 1\n    message = {"data": {"orderId": n}}\n\n    try:\n        response = requests.post(dapr_url, json=message)\n    except Exception as e:\n        print(e)\n\n    time.sleep(1)\n')),r.createElement(t.p,null,"The Dapr sidecar for the Python application sends a POST request to the Dapr sidecar of the Node.js application using the ",r.createElement(t.strong,null,"Dapr service invocation API"),". Here's a breakdown of what happens;"),r.createElement(t.ol,null,"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,"The Python app sends a POST request to its sidecar at http://localhost:3500/v1.0/invoke/nodeapp/method/neworder. ",r.createElement(t.em,null,"Note: http://localhost:3500 is the default listening port for Dapr"),"."),"\n"),"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,"The sidecar for the Python app invokes the nodeapp service through its own Dapr sidecar."),"\n"),"\n"),r.createElement(t.p,null,"The Python app does not need to know the exact address or port of the Node.js service, it simply makes a request to its sidecar, which handles the routing."),r.createElement(t.p,null,r.createElement(t.strong,null,"Steps to Stream Python Application Logs"),":"),r.createElement(t.ol,null,"\n",r.createElement(t.li,null,"Click on the ",r.createElement(t.strong,null,"python-app")," pod."),"\n",r.createElement(t.li,null,"On the right sidebar, click on ",r.createElement(t.strong,null,"Action"),"."),"\n",r.createElement(t.li,null,"Click on ",r.createElement(t.strong,null,"Stream Container logs"),"."),"\n"),r.createElement("a",{href:l},r.createElement("img",{src:l,width:"100%",align:"center"})),r.createElement(t.p,null,"The logs show the daprd container logs with a POST request made to ",r.createElement(t.strong,null,"/neworder")," endpoint."),r.createElement("h3",{className:"chapter-sub-heading"},"Node.js Application Logs"),r.createElement(t.p,null,"Follow the same steps above to get the logs for the Node.js application. The logs show API calls made to the state store for persisting order data."),r.createElement(t.p,null,"Here's what can be observed from the logs:"),r.createElement(t.ol,null,"\n",r.createElement(t.li,null,"The Dapr sidecar of the Node.js application listens on port 3500 for incoming HTTP requests."),"\n",r.createElement(t.li,null,"The sidecar receives the invocation request sent from the sidecar of the Python app and routes it to the ",r.createElement(t.strong,null,"/neworder")," endpoint in the Node.js application."),"\n",r.createElement(t.li,null,"The sidecar makes a POST request to the state store endpoint (/v1.0/state/statestore) to persist the state information in Redis. This endpoint is part of the ",r.createElement(t.strong,null,"Dapr state management API"),"  and is mapped to the configured state store component."),"\n"),r.createElement(t.p,null,"By analyzing these logs, we gained a deeper understanding of how Dapr's APIs such as the state management API and service invocation API work together to enable service-service communication and efficient management of application state."))}var c=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.R)(),e.components);return t?r.createElement(t,e,r.createElement(s,e)):s(e)},i=n(60522),p=n(79681),h=n(63562);const m=e=>{let{data:t,location:n,children:a}=e;const o=t.TOC.nodes.sort((e,t)=>{var n,a;return(null!==(n=e.frontmatter)&&void 0!==n&&n.order?e.frontmatter.order:100)-(null!==(a=t.frontmatter)&&void 0!==a&&a.order?t.frontmatter.order:100)});return r.createElement(r.Fragment,null,r.createElement(h.Ay,null,r.createElement(p.A,{chapterData:t.chapter,TOCData:o,courseData:t.course.nodes[0],location:n,serviceMeshesList:t.TOC.nodes},a)))};function d(e){return r.createElement(m,e,r.createElement(c,e))}const u=e=>{let{data:t}=e;return r.createElement(i.A,{title:t.chapter.frontmatter.chapterTitle,canonical:"https://layer5.io/learn/learning-paths"})}}}]);